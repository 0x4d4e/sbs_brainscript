% Brainfuck interpreter/debugger in Postscript
%
%

/max-size 30000 def


/read-file { (r) file max-size string readstring true eq {(code zu lang) =} if } def


% array value -- array
/init-array {
	exch dup 						% value arr arr
	3 1 roll 						% arr v arr
	dup 0 1 3 2 roll length 1 sub 	% a v a 0 1 l-1
	{ 								% a v a i
		2 copy 						% a v a i a i
		4 index 					% a v a i a i v
		put pop 					% a v a
	} for
	pop pop 						% a
} def



/bf-init {
	3 dict <<
	(bf-in) stack 4 -1 roll read-file			% do we need filename later? use 3 index otherwise
	(bf-tape) max-size array 0 init-array
	(bf-out) max-size array
	>>
	0
	0
} def


/bf-run {
	bf-init
} def